== 2011-08-19
まずはBroadcastからServiceを起動できるようにしてみた。

== 2011-08-20
- Serviceは音が鳴っている間起動していようにするのだろう
  - 違う。SCREEN_OFFを検出するのはService。
- Serviceの起動まではAlarmManager?を使う
- Serviceが起動していない時のアプリの状態はどのように検出する？

状態変化

[シエスタウォッチOffの状態(Off)]
- アラームOn操作
- Serviceを起動
- 寝るのを待ってる状態(Standby)

[寝るのを待ってる状態(Standby)]
- アラームOff操作
- Serviceを停止
- (Off)

- ACTION_SCREEN_OFFが来る
- アラーム時刻の設定
- (Countdown)

[カウントダウン中 (Countdown)]
- ACTION_USER_PRESENTが来る
- アラーム時刻の解除
- (Standby)

- アラーム時刻が来る
- アラーム音を鳴らす
- (Alarm)

[アラームが鳴っている最中 (Alarm)]
- ACTION_SCREEN_ONが来る
- アラーム音を止める
- (Silent)

- ACTION_USER_PRESENTが来る
- アラーム音を止める
- Serviceを停止
- (Off)

[アラームを停止中 (Silent)]
- ACTION_SCREEN_OFFが来る
- アラーム音を再開する
- (Alarm)

- ACTION_USER_PRESENTが来る
- アラーム音を止める
- Serviceを停止
- (Off)

[その他」
- Acivityの起動時
  - (Off)だったら(Off)それ以外だったら(Standby)かな

ServiceがIntentを受ける必要があるね - onStart()は何度でも呼んでも
らえるようだ。Activityや自身からの電文をExtrasに入れればいいかも。

START_STICKY is used for services that are explicitly started and stopped as
needed

onStartは古い実装のようだ。onStartCommandでSTART_STICKYを返せた方が良いので
http://developer.android.com/reference/android/app/Service.html#onStartCommand%28android.content.Intent,%20int,%20int%29
より下記のようにしておく:

If you need your application to run on platform versions prior to API level 5,
you can use the following model to handle the older onStart(Intent, int)
callback in that case. The handleCommand method is implemented by you as
appropriate: 

// This is the old onStart method that will be called on the pre-2.0
// platform.  On 2.0 or later we override onStartCommand() so this
// method will not be called.
@Override
public void onStart(Intent intent, int startId) {
    handleCommand(intent);
}

@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    handleCommand(intent);
    // We want this service to continue running until it is explicitly
    // stopped, so return sticky.
    return START_STICKY;
}

onStartCommandからsuper.onStartCommand()を呼ぶと
もう一度onStartCommandが呼ばれるようだ。

onStartが何度来てもregisterReceiverは一度しか呼ばないようにした。

http://developer.android.com/resources/samples/ApiDemos/tests/src/com/example/android/apis/app/LocalServiceTest.html
よりServiceのテストケースを書いてみている。

ServiceからActivityへの通信はいまのところ不要と思っておこう。アラー
ムの設定や解除の時には必要になればServiceからToastやNotification
を使うことを考える。

== 2011-08-25
ADP-1で放っておいたら、Screen Onをした瞬間に落ちた


D/dalvikvm( 1171): GC_FOR_MALLOC freed 4553 objects / 270048 bytes in 116ms
I/Swapper ( 1164): Waiting for SD card
I/ActivityManager(  158): Start proc com.edamametech.android.SiestaWatch:alarmManageer for service com.edamametech.android.SiestaWatch/.SiestaWatchService: pid=1198 uid=10056 gids={}
I/Swapper ( 1164): SD card found
I/SwapperAutorunService( 1164): Started
I/ActivityManager(  158): Process com.google.android.apps.uploader (pid 1029) has died.
V/SiestaWatchService( 1198): SiestaWatchService.onCreate()
V/SiestaWatchService( 1198): Registering screenEvents
V/SiestaWatchService( 1198): SiestaWatchService.handleStartCommand()
D/AndroidRuntime( 1198): Shutting down VM
W/dalvikvm( 1198): threadid=1: thread exiting with uncaught exception (group=0x400207e8)
E/AndroidRuntime( 1198): FATAL EXCEPTION: main
E/AndroidRuntime( 1198): java.lang.RuntimeException: Unable to start service com.edamametech.android.SiestaWatch.SiestaWatchService@43dc9f08 with null: java.lang.NullPointerException
E/AndroidRuntime( 1198):        at android.app.ActivityThread.handleServiceArgs(ActivityThread.java:3063)
E/AndroidRuntime( 1198):        at android.app.ActivityThread.access$3600(ActivityThread.java:125)
E/AndroidRuntime( 1198):        at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2096)
E/AndroidRuntime( 1198):        at android.os.Handler.dispatchMessage(Handler.java:99)
E/AndroidRuntime( 1198):        at android.os.Looper.loop(Looper.java:123)
E/AndroidRuntime( 1198):        at android.app.ActivityThread.main(ActivityThread.java:4627)
E/AndroidRuntime( 1198):        at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime( 1198):        at java.lang.reflect.Method.invoke(Method.java:521)
E/AndroidRuntime( 1198):        at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
E/AndroidRuntime( 1198):        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
E/AndroidRuntime( 1198):        at dalvik.system.NativeStart.main(Native Method)
E/AndroidRuntime( 1198): Caused by: java.lang.NullPointerException
E/AndroidRuntime( 1198):        at com.edamametech.android.SiestaWatch.SiestaWatchService.handleStartCommand(SiestaWatchService.java:89)
E/AndroidRuntime( 1198):        at com.edamametech.android.SiestaWatch.SiestaWatchService.onStartCommand(SiestaWatchService.java:81)
E/AndroidRuntime( 1198):        at android.app.ActivityThread.handleServiceArgs(ActivityThread.java:3053)
E/AndroidRuntime( 1198):        ... 10 more
I/global  ( 1164): Default buffer size used in BufferedInputStream constructor. It would be better to be explicit if an 8k buffer is required.
I/global  ( 1164): Default buffer size used in BufferedInputStream constructor. It would be better to be explicit if an 8k buffer is required.
I/ActivityManager(  158): Process com.google.android.gm (pid 1037) has died.
I/ActivityManager(  158): Low Memory: No more background processes.
D/dalvikvm( 1171): GC_FOR_MALLOC freed 2027 objects / 314696 bytes in 230ms
I/global  ( 1164): Default buffer size used in BufferedInputStream constructor. It would be better to be explicit if an 8k buffer is required.
I/global  ( 1164): Default buffer size used in BufferedInputStream constructor. It would be better to be explicit if an 8k buffer is required.
I/Swapper ( 1164): Swap setup
I/Swapper ( 1164): Command:     echo 10 > /proc/sys/vm/swappiness
D/WifiService(  158): acquireWifiLockLocked: WifiLock{NetworkLocationProvider type=2 binder=android.os.Binder@43f06800}
D/dalvikvm( 1171): GC_FOR_MALLOC freed 2084 objects / 458752 bytes in 341ms
D/dalvikvm( 1171): GC_EXTERNAL_ALLOC freed 1314 objects / 464456 bytes in 215ms
I/WindowManager(  158): WIN DEATH: Window{43f592e0 com.android.launcher/com.android.launcher.Launcher paused=false}
I/ActivityManager(  158): Process android.process.acore (pid 234) has died.
I/ActivityManager(  158): Low Memory: No more background processes.
I/ActivityManager(  158): Start proc android.process.acore for content provider com.android.providers.contacts/.ContactsProvider2: pid=1218 uid=10004 gids={1015, 3003}
D/LocationMasfClient(  158): getNetworkLocation(): Location not found in cache, making network request
I/ActivityThread( 1218): Publishing provider com.android.launcher.settings: com.android.launcher.LauncherProvider
I/ActivityThread( 1218): Publishing provider user_dictionary: com.android.providers.userdictionary.UserDictionaryProvider
I/ActivityThread( 1218): Publishing provider com.android.social: com.android.providers.contacts.SocialProvider
I/ActivityThread( 1218): Publishing provider applications: com.android.providers.applications.ApplicationsProvider
I/ActivityThread( 1218): Publishing provider contacts;com.android.contacts: com.android.providers.contacts.ContactsProvider2
D/dalvikvm(  158): GC_FOR_MALLOC freed 14389 objects / 817768 bytes in 329ms
W/LocationMasfClient(  158): uploadCollectionReport(): no ReplyElement
D/LocationMasfClient(  158): getNetworkLocation(): Number of prefetched entries 7
D/LocationMasfClient(  158): getNetworkLocation(): Returning network location with accuracy 65.0
I/ActivityThread( 1218): Publishing provider call_log: com.android.providers.contacts.CallLogProvider
D/dalvikvm( 1218): GC_FOR_MALLOC freed 2815 objects / 196888 bytes in 141ms
I/ActivityManager(  158): Start proc com.noshufou.android.su for broadcast com.noshufou.android.su/.SuNotificationReceiver: pid=1229 uid=10035 gids={1015, 3003}
D/su      ( 1209): 10009 lv.n3o.swapper2 executing 0 /system/bin/sh using shell /system/bin/sh : sh
D/su      ( 1205): 10009 lv.n3o.swapper2 executing 0 /system/bin/sh using shell /system/bin/sh : sh
D/WifiService(  158): releaseWifiLockLocked: WifiLock{NetworkLocationProvider type=2 binder=android.os.Binder@43f06800}
I/Swapper ( 1164): H=null EXEC Setting swappiness RESULT true
E/Swapper ( 1164): 
E/Swapper ( 1164): 
E/Swapper ( 1164): 
I/Swapper ( 1164): Command:     busybox swapon /dev/block/mmcblk0p3
I/ActivityManager(  158): Process android.process.acore (pid 1218) has died.
I/ActivityManager(  158): Low Memory: No more background processes.
I/Swapper ( 1164): H=null EXEC Enabling swap(partition) RESULT false
E/Swapper ( 1164): 
E/Swapper ( 1164): swapon: /dev/block/mmcblk0p3: Device or resource busy
E/Swapper ( 1164): 
E/Swapper ( 1164): 
I/ActivityManager(  158): Start proc android.process.acore for content provider com.android.providers.contacts/.ContactsProvider2: pid=1240 uid=10004 gids={1015, 3003}
I/ActivityThread( 1240): Publishing provider com.android.launcher.settings: com.android.launcher.LauncherProvider
I/ActivityThread( 1240): Publishing provider user_dictionary: com.android.providers.userdictionary.UserDictionaryProvider
I/ActivityThread( 1240): Publishing provider com.android.social: com.android.providers.contacts.SocialProvider
I/ActivityThread( 1240): Publishing provider applications: com.android.providers.applications.ApplicationsProvider
I/ActivityThread( 1240): Publishing provider contacts;com.android.contacts: com.android.providers.contacts.ContactsProvider2
I/ActivityThread( 1240): Publishing provider call_log: com.android.providers.contacts.CallLogProvider
D/dalvikvm( 1240): GC_FOR_MALLOC freed 2916 objects / 201072 bytes in 113ms
W/ActivityManager(  158): Timeout executing service: ServiceRecord{43f3da00 com.edamametech.android.SiestaWatch/.SiestaWatchService}
I/ActivityManager(  158): Crashing app skipping ANR: ProcessRecord{43f3d468 1198:com.edamametech.android.SiestaWatch:alarmManageer/10056} Executing service com.edamametech.android.SiestaWatch/.SiestaWatchService
I/ActivityManager(  158): Process com.noshufou.android.su (pid 1229) has died.
I/ActivityManager(  158): Process android.process.acore (pid 1240) has died.
I/ActivityManager(  158): Low Memory: No more background processes.
D/dalvikvm(  347): GC_EXPLICIT freed 84 objects / 2976 bytes in 126ms
D/skia    (  158): purging 260K from font cache [24 entries]
D/dalvikvm(  158): GC_EXPLICIT freed 6207 objects / 301736 bytes in 252ms

FCのボタンを押した。

I/Process ( 1198): Sending signal. PID: 1198 SIG: 9
W/InputManagerService(  158): Window already focused, ignoring focus gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@43d7f588
I/ActivityManager(  158): Process com.edamametech.android.SiestaWatch:alarmManageer (pid 1198) has died.
W/ActivityManager(  158): Scheduling restart of crashed service com.edamametech.android.SiestaWatch/.SiestaWatchService in 5000ms
I/ActivityManager(  158): Low Memory: No more background processes.
I/ActivityManager(  158): Start proc com.android.settings for broadcast com.android.settings/.widget.SettingsAppWidgetProvider: pid=1264 uid=1000 gids={3003, 1015, 3002, 3001}
D/ConnectivityService(  158): getMobileDataEnabled returning false
D/SettingsAppWidgetProvider( 1264): Call buildUpdate for widget:4
D/SettingsAppWidgetProvider( 1264): buildUpdate done for widget:4
I/ActivityManager(  158): Start proc com.edamametech.android.SiestaWatch:alarmManageer for service com.edamametech.android.SiestaWatch/.SiestaWatchService: pid=1270 uid=10056 gids={}
V/SiestaWatchService( 1270): SiestaWatchService.onCreate()
V/SiestaWatchService( 1270): Registering screenEvents
V/SiestaWatchService( 1270): SiestaWatchService.handleStartCommand()
D/AndroidRuntime( 1270): Shutting down VM
W/dalvikvm( 1270): threadid=1: thread exiting with uncaught exception (group=0x400207e8)
E/AndroidRuntime( 1270): FATAL EXCEPTION: main
E/AndroidRuntime( 1270): java.lang.RuntimeException: Unable to start service com.edamametech.android.SiestaWatch.SiestaWatchService@43dc9f08 with null: java.lang.NullPointerException
E/AndroidRuntime( 1270): 	at android.app.ActivityThread.handleServiceArgs(ActivityThread.java:3063)
E/AndroidRuntime( 1270): 	at android.app.ActivityThread.access$3600(ActivityThread.java:125)
E/AndroidRuntime( 1270): 	at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2096)
E/AndroidRuntime( 1270): 	at android.os.Handler.dispatchMessage(Handler.java:99)
E/AndroidRuntime( 1270): 	at android.os.Looper.loop(Looper.java:123)
E/AndroidRuntime( 1270): 	at android.app.ActivityThread.main(ActivityThread.java:4627)
E/AndroidRuntime( 1270): 	at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime( 1270): 	at java.lang.reflect.Method.invoke(Method.java:521)
E/AndroidRuntime( 1270): 	at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
E/AndroidRuntime( 1270): 	at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
E/AndroidRuntime( 1270): 	at dalvik.system.NativeStart.main(Native Method)
E/AndroidRuntime( 1270): Caused by: java.lang.NullPointerException
E/AndroidRuntime( 1270): 	at com.edamametech.android.SiestaWatch.SiestaWatchService.handleStartCommand(SiestaWatchService.java:89)
E/AndroidRuntime( 1270): 	at com.edamametech.android.SiestaWatch.SiestaWatchService.onStartCommand(SiestaWatchService.java:81)
E/AndroidRuntime( 1270): 	at android.app.ActivityThread.handleServiceArgs(ActivityThread.java:3053)
E/AndroidRuntime( 1270): 	... 10 more
D/dalvikvm(  347): GC_EXPLICIT freed 6 objects / 208 bytes in 111ms
W/TabControl( 1171): Free WebView's unused memory and cache
D/skia    ( 1171): purging 44K from font cache [5 entries]
D/dalvikvm( 1171): GC_EXPLICIT freed 1016 objects / 31688 bytes in 139ms
D/skia    (  158): purging 132K from font cache [12 entries]
D/dalvikvm(  158): GC_EXPLICIT freed 4689 objects / 271072 bytes in 243ms
I/EventLogService(  761): Aggregate from 1314321718664 (log), 1314321718664 (data)
D/dalvikvm(  229): GC_EXPLICIT freed 79 objects / 3616 bytes in 114ms
W/ActivityManager(  158): Timeout executing service: ServiceRecord{43f3da00 com.edamametech.android.SiestaWatch/.SiestaWatchService}
I/ActivityManager(  158): Crashing app skipping ANR: ProcessRecord{43fa5448 1270:com.edamametech.android.SiestaWatch:alarmManageer/10056} Executing service com.edamametech.android.SiestaWatch/.SiestaWatchService
D/skia    ( 1252): purging 6K from font cache [1 entries]

またFCのダイアログが出た

I/Process ( 1270): Sending signal. PID: 1270 SIG: 9
I/ActivityManager(  158): Process com.edamametech.android.SiestaWatch:alarmManageer (pid 1270) has died.
W/ActivityManager(  158): Service crashed 2 times, stopping: ServiceRecord{43f3da00 com.edamametech.android.SiestaWatch/.SiestaWatchService}

Intentのnullチェックを増やした。

状態の永続化が必要なんかな…

SharedPreferencesの使い方
http://developer.android.com/resources/samples/ApiDemos/src/com/example/android/apis/app/PersistentState.html

下記。ADP-1を放っておいたらScreen onにする時に何か起きた。

08-26 11:03:55.080: DEBUG/dalvikvm(160): GC_FOR_MALLOC freed 3247 objects / 177336 bytes in 166ms
08-26 11:04:55.490: INFO/WindowManager(160): Setting rotation to 1, animFlags=1
08-26 11:04:55.510: INFO/ActivityManager(160): Config changed: { scale=1.0 imsi=0/0 loc=ja_JP touch=3 keys=2/1/1 nav=3/1 orien=2 layout=18 uiMode=17 seq=3}
08-26 11:04:55.590: DEBUG/KeyguardViewMediator(160): wakeWhenReadyLocked(26)
08-26 11:04:55.730: DEBUG/HomeLoaders(239): aborting loaders
08-26 11:04:55.730: INFO/GPSButton(160): Update State
08-26 11:04:56.130: DEBUG/dalvikvm(239): GC_EXPLICIT freed 1725 objects / 87168 bytes in 359ms
08-26 11:04:56.790: DEBUG/KeyguardViewMediator(160): handleWakeWhenReady(26)
08-26 11:04:56.800: DEBUG/KeyguardViewMediator(160): pokeWakelock(10000)
08-26 11:04:56.810: INFO/power(160): *** set_screen_state 1
08-26 11:04:56.850: DEBUG/AKMD(127): Compass OPEN 
08-26 11:04:56.850: DEBUG/Sensors(160): sensors=00000001, real=00000001
08-26 11:04:56.930: DEBUG/SurfaceFlinger(160): Screen about to return, flinger = 0x114130
08-26 11:04:57.340: INFO/ActivityManager(160): Process lv.n3o.swapper2 (pid 645) has died.
08-26 11:04:57.350: WARN/ActivityManager(160): Scheduling restart of crashed service lv.n3o.swapper2/.SwapperAutorunService in 5000ms
08-26 11:04:57.850: INFO/ActivityManager(160): Process com.android.settings (pid 506) has died.
08-26 11:04:58.380: DEBUG/dalvikvm(160): GC_FOR_MALLOC freed 3952 objects / 247632 bytes in 189ms
08-26 11:04:58.430: DEBUG/WifiService(160): ACTION_SCREEN_ON
08-26 11:04:58.430: DEBUG/WifiStateTracker(160): Reset connections and stopping DHCP
08-26 11:04:58.510: VERBOSE/SiestaWatchService(699): Intent { act=android.intent.action.SCREEN_ON flg=0x40000000 }
08-26 11:04:58.510: VERBOSE/SiestaWatchService(699): com.edamametech.android.SiestaWatch.SiestaWatchService@43dca7e8
08-26 11:04:58.510: VERBOSE/SiestaWatchService(699): screenEventReceiver.onReceive()
08-26 11:04:58.560: INFO/ActivityManager(160): Start proc com.android.settings for broadcast com.android.settings/.widget.SettingsAppWidgetProvider: pid=796 uid=1000 gids={3003, 1015, 3002, 3001}
08-26 11:04:59.190: DEBUG/WindowManager(160): I'm tired mEndcallBehavior=0x2
08-26 11:04:59.420: INFO/power(160): *** set_screen_state 0
08-26 11:04:59.450: DEBUG/Sensors(160): sensors=00000000, real=00000000
08-26 11:04:59.460: DEBUG/WifiStateTracker(160): Disabling interface
08-26 11:04:59.460: VERBOSE/WifiMonitor(160): Event [CTRL-EVENT-DRIVER-STATE STARTED]
08-26 11:04:59.470: VERBOSE/WifiMonitor(160): Event [CTRL-EVENT-STATE-CHANGE id=-1 state=2]
08-26 11:04:59.500: DEBUG/ConnectivityService(160): Dropping ConnectivityChange for WIFI: DISCONNECTED/SCANNING
08-26 11:04:59.500: DEBUG/NetworkStateTracker(160): setDetailed state, old =IDLE and new state=SCANNING
08-26 11:04:59.500: VERBOSE/WifiStateTracker(160): Changing supplicant state: DORMANT ==> SCANNING
08-26 11:04:59.630: DEBUG/AKMD(127): Compass CLOSE 
08-26 11:04:59.640: DEBUG/ConnectivityService(160): getMobileDataEnabled returning false
08-26 11:04:59.760: DEBUG/SettingsAppWidgetProvider(796): Call buildUpdate for widget:4
08-26 11:04:59.780: DEBUG/SurfaceFlinger(160): About to give-up screen, flinger = 0x114130
08-26 11:04:59.840: DEBUG/ConnectivityService(160): ConnectivityChange for WIFI: CONNECTING/CONNECTING
08-26 11:04:59.840: DEBUG/NetworkStateTracker(160): setDetailed state, old =SCANNING and new state=CONNECTING
08-26 11:04:59.840: VERBOSE/WifiMonitor(160): Event [CTRL-EVENT-STATE-CHANGE id=-1 state=3]
08-26 11:04:59.840: VERBOSE/WifiMonitor(160): Event [Trying to associate with 00:23:04:31:04:50 (SSID='sbr-hilo' freq=2462 MHz)]
08-26 11:04:59.840: VERBOSE/WifiStateTracker(160): Changing supplicant state: SCANNING ==> ASSOCIATING
08-26 11:04:59.860: WARN/WifiService(160): misformatted scan result for: 00:11:24:a5:d1:32    2447    -92    [WEP]        
08-26 11:04:59.950: DEBUG/SettingsAppWidgetProvider(796): buildUpdate done for widget:4
08-26 11:05:00.000: INFO/ActivityManager(160): Start proc com.google.android.googlequicksearchbox for broadcast com.google.android.googlequicksearchbox/.SearchWidgetProvider: pid=802 uid=10049 gids={3003}
08-26 11:05:00.000: WARN/ActivityManager(160): Activity pause timeout for HistoryRecord{43dd0e78 com.android.launcher/.Launcher}
08-26 11:05:00.430: DEBUG/dalvikvm(122): GC_EXPLICIT freed 289 objects / 11008 bytes in 410ms
08-26 11:05:00.560: WARN/WindowManager(160): App freeze timeout expired.
08-26 11:05:00.560: WARN/WindowManager(160): Force clearing freeze: AppWindowToken{43e9a330 token=HistoryRecord{43dd0e78 com.android.launcher/.Launcher}}
08-26 11:05:00.740: VERBOSE/WifiMonitor(160): Event [CTRL-EVENT-STATE-CHANGE id=3 state=4]
08-26 11:05:00.750: DEBUG/NetworkStateTracker(160): setDetailed state, old =CONNECTING and new state=CONNECTING
08-26 11:05:00.750: VERBOSE/WifiMonitor(160): Event [Associated with 00:23:04:31:04:50]
08-26 11:05:00.750: VERBOSE/WifiStateTracker(160): Changing supplicant state: ASSOCIATING ==> ASSOCIATED
08-26 11:05:00.760: VERBOSE/WifiMonitor(160): Event [CTRL-EVENT-STATE-CHANGE id=3 state=5]
08-26 11:05:00.800: DEBUG/ConnectivityService(160): Dropping ConnectivityChange for WIFI: CONNECTING/AUTHENTICATING
08-26 11:05:00.800: DEBUG/NetworkStateTracker(160): setDetailed state, old =CONNECTING and new state=AUTHENTICATING
08-26 11:05:00.800: VERBOSE/WifiStateTracker(160): Changing supplicant state: ASSOCIATED ==> FOUR_WAY_HANDSHAKE
08-26 11:05:00.840: VERBOSE/WifiMonitor(160): Event [CTRL-EVENT-STATE-CHANGE id=3 state=5]
08-26 11:05:00.840: VERBOSE/WifiStateTracker(160): Changing supplicant state: FOUR_WAY_HANDSHAKE ==> FOUR_WAY_HANDSHAKE
08-26 11:05:00.850: VERBOSE/WifiMonitor(160): Event [CTRL-EVENT-STATE-CHANGE id=3 state=6]
08-26 11:05:00.880: DEBUG/NetworkStateTracker(160): setDetailed state, old =AUTHENTICATING and new state=AUTHENTICATING
08-26 11:05:00.880: VERBOSE/WifiMonitor(160): Event [CTRL-EVENT-STATE-CHANGE id=3 state=7]
08-26 11:05:00.880: VERBOSE/WifiMonitor(160): Event [WPA: Key negotiation completed with 00:23:04:31:04:50 [PTK=CCMP GTK=CCMP]]
08-26 11:05:00.880: VERBOSE/WifiStateTracker(160): Changing supplicant state: FOUR_WAY_HANDSHAKE ==> GROUP_HANDSHAKE
08-26 11:05:00.890: VERBOSE/WifiStateTracker(160): Changing supplicant state: GROUP_HANDSHAKE ==> COMPLETED
08-26 11:05:00.900: VERBOSE/WifiMonitor(160): Event [CTRL-EVENT-CONNECTED - Connection to 00:23:04:31:04:50 completed (reauth) [id=3 id_str=]]
08-26 11:05:00.910: VERBOSE/WifiStateTracker(160): New network state is CONNECTED
08-26 11:05:00.920: DEBUG/dalvikvm(122): GC_EXPLICIT freed 47 objects / 2072 bytes in 451ms
08-26 11:05:00.950: DEBUG/WifiStateTracker(160): DhcpHandler: DHCP request started
08-26 11:05:00.960: DEBUG/NetworkStateTracker(160): setDetailed state, old =AUTHENTICATING and new state=OBTAINING_IPADDR
08-26 11:05:01.000: DEBUG/ConnectivityService(160): Dropping ConnectivityChange for WIFI: CONNECTING/OBTAINING_IPADDR
08-26 11:05:01.110: INFO/ActivityThread(802): Publishing provider com.google.android.googlequicksearchbox.shortcuts: com.google.android.googlequicksearchbox.ShortcutsProvider
08-26 11:05:01.200: INFO/ActivityThread(802): Publishing provider com.google.android.googlequicksearchbox.google: com.google.android.googlequicksearchbox.google.GoogleSuggestionProvider
08-26 11:05:01.520: DEBUG/dalvikvm(122): GC_EXPLICIT freed 2 objects / 64 bytes in 583ms
08-26 11:05:02.400: INFO/ActivityManager(160): Start proc lv.n3o.swapper2 for service lv.n3o.swapper2/.SwapperAutorunService: pid=823 uid=10009 gids={3003, 1015}
08-26 11:05:02.440: DEBUG/GoogleLoginService(451): onBind: Intent { act=android.accounts.AccountAuthenticator cmp=com.google.android.gsf/.loginservice.GoogleLoginService }
08-26 11:05:02.940: DEBUG/dalvikvm(160): GC_EXPLICIT freed 3552 objects / 193248 bytes in 375ms
08-26 11:05:03.030: DEBUG/HomeLoaders(239):   --> applications loaded, return
08-26 11:05:03.030: DEBUG/HomeLoaders(239): load applications
08-26 11:05:03.080: DEBUG/HomeLoaders(239): loading user items in Thread[main,5,main]
08-26 11:05:03.100: DEBUG/HomeLoaders(239):   --> items loaded, return
08-26 11:05:03.120: DEBUG/HomeLoaders(239):   --> loading from cache: 13, 2
08-26 11:05:03.120: DEBUG/Launcher(239): ------> binding 13 items
08-26 11:05:03.120: DEBUG/Launcher(239): ------> binding 2 widgets
08-26 11:05:03.120: DEBUG/Launcher(239): ------> start binding items

↓ここで落ちた
08-26 11:05:03.190: INFO/ActivityManager(160): Process com.edamametech.android.SiestaWatch:alarmManageer (pid 699) has died.
08-26 11:05:03.190: WARN/ActivityManager(160): Scheduling restart of crashed service com.edamametech.android.SiestaWatch/.SiestaWatchService in 5000ms
08-26 11:05:03.420: INFO/GPSButton(160): Update State
08-26 11:05:03.480: INFO/Swapper(823): Setting up service
08-26 11:05:03.500: DEBUG/WifiService(160): ACTION_SCREEN_OFF
08-26 11:05:03.550: DEBUG/WifiService(160): setting ACTION_DEVICE_IDLE timer for 900000ms
08-26 11:05:03.790: WARN/ActivityManager(160):     at android.app.ActivityManagerNative.onTransact(ActivityManagerNative.java:341)
08-26 11:05:03.790: WARN/ActivityManager(160):     at android.content.IIntentReceiver$Stub$Proxy.performReceive(IIntentReceiver.java:121)
08-26 11:05:03.790: WARN/ActivityManager(160):     at android.os.Binder.execTransact(Binder.java:288)
08-26 11:05:03.790: WARN/ActivityManager(160):     at android.os.BinderProxy.transact(Native Method)
08-26 11:05:03.790: WARN/ActivityManager(160):     at com.android.server.am.ActivityManagerService.deliverToRegisteredReceiver(ActivityManagerService.java:13049)
08-26 11:05:03.790: WARN/ActivityManager(160):     at com.android.server.am.ActivityManagerService.finishReceiver(ActivityManagerService.java:12847)
08-26 11:05:03.790: WARN/ActivityManager(160):     at com.android.server.am.ActivityManagerService.onTransact(ActivityManagerService.java:1481)
08-26 11:05:03.790: WARN/ActivityManager(160):     at com.android.server.am.ActivityManagerService.performReceive(ActivityManagerService.java:12987)
08-26 11:05:03.790: WARN/ActivityManager(160):     at com.android.server.am.ActivityManagerService.processNextBroadcast(ActivityManagerService.java:13252)
08-26 11:05:03.790: WARN/ActivityManager(160):     at dalvik.system.NativeStart.run(Native Method)
08-26 11:05:03.790: WARN/ActivityManager(160): Failure sending broadcast Intent { act=android.intent.action.SCREEN_OFF flg=0x40000000 }
08-26 11:05:03.790: WARN/ActivityManager(160): android.os.DeadObjectException
08-26 11:05:03.820: INFO/SIMEJI(769): KILLME
08-26 11:05:03.840: INFO/AndroidRuntime(769): AndroidRuntime onExit calling exit(0)
08-26 11:05:04.040: INFO/ActivityManager(160): Process com.adamrocker.android.input.simeji (pid 769) has died.
08-26 11:05:04.050: WARN/ActivityManager(160): Scheduling restart of crashed service com.adamrocker.android.input.simeji/.OpenWnnSimeji in 14148ms
08-26 11:05:04.440: DEBUG/dalvikvm(239): GC_FOR_MALLOC freed 5688 objects / 374264 bytes in 120ms
08-26 11:05:04.960: VERBOSE/WifiStateTracker(160): DhcpHandler: DHCP request succeeded
08-26 11:05:04.970: DEBUG/NetworkStateTracker(160): setDetailed state, old =OBTAINING_IPADDR and new state=CONNECTED
08-26 11:05:04.980: VERBOSE/WifiStateTracker(160): IP configuration: ipaddr 133.40.145.172 gateway 133.40.147.254 netmask 255.255.252.0 dns1 133.40.143.196 dns2 133.40.172.25 DHCP server 127.0.0.1 lease 86400 seconds
08-26 11:05:05.000: DEBUG/ConnectivityService(160): ConnectivityChange for WIFI: CONNECTED/CONNECTED
08-26 11:05:05.000: VERBOSE/NetworkStateTracker(160): Setting TCP values: [4095,87380,110208,4096,16384,110208] which comes from [net.tcp.buffersize.wifi]
08-26 11:05:05.070: DEBUG/WifiWatchdogService(160): (android.server.ServerThread) sbr-hilo (00:23:04:31:04:50) does not require the watchdog
08-26 11:05:05.090: DEBUG/ConnectivityService(160): adding dns 133.40.143.196 for WIFI
08-26 11:05:05.100: DEBUG/ConnectivityService(160): adding dns 133.40.172.25 for WIFI
08-26 11:05:05.120: DEBUG/Tethering(160): MasterInitialState.processMessage what=3
08-26 11:05:05.120: DEBUG/Tethering(160): Tethering got CONNECTIVITY_ACTION
08-26 11:05:05.120: ERROR/HierarchicalStateMachine(160): TetherMaster - unhandledMessage: msg.what=3
08-26 11:05:05.180: DEBUG/NetworkLocationProvider(160): updateNetworkState(): Updating network state to 2
08-26 11:05:05.250: DEBUG/GpsLocationProvider(160): updateNetworkState available info: NetworkInfo: type: WIFI[], state: CONNECTED/CONNECTED, reason: (unspecified), extra: (none), roaming: false, failover: false, isAvailable: true
08-26 11:05:05.310: INFO/GTalkService(451): [ServiceAutoStarter] --- connectivity changed
08-26 11:05:05.310: INFO/GTalkService(451): [ServiceAutoStarter] --- start GTalk service ---
08-26 11:05:05.380: INFO/MediaUploader(586): No need to wake up

↓再起動
08-26 11:05:08.260: INFO/ActivityManager(160): Start proc com.edamametech.android.SiestaWatch:alarmManageer for service com.edamametech.android.SiestaWatch/.SiestaWatchService: pid=855 uid=10056 gids={}
08-26 11:05:08.480: INFO/Swapper(823): Waiting for SD card
08-26 11:05:08.560: VERBOSE/SiestaWatchService(855): Registering screenEvents
08-26 11:05:08.560: VERBOSE/SiestaWatchService(855): SiestaWatchService.onCreate()
08-26 11:05:08.570: INFO/Swapper(823): SD card found
08-26 11:05:08.570: VERBOSE/SiestaWatchService(855): SiestaWatchService.handleStartCommand()
08-26 11:05:08.590: INFO/SwapperAutorunService(823): Started
08-26 11:05:08.640: INFO/global(823): Default buffer size used in BufferedInputStream constructor. It would be better to be explicit if an 8k buffer is required.
08-26 11:05:08.640: INFO/global(823): Default buffer size used in BufferedInputStream constructor. It would be better to be explicit if an 8k buffer is required.
08-26 11:05:08.850: INFO/global(823): Default buffer size used in BufferedInputStream constructor. It would be better to be explicit if an 8k buffer is required.
08-26 11:05:08.860: INFO/Swapper(823): Swap setup
08-26 11:05:08.860: INFO/global(823): Default buffer size used in BufferedInputStream constructor. It would be better to be explicit if an 8k buffer is required.
08-26 11:05:09.700: INFO/Swapper(823): Command:    echo 10 > /proc/sys/vm/swappiness
08-26 11:05:10.650: DEBUG/su(864): 10009 lv.n3o.swapper2 executing 0 /system/bin/sh using shell /system/bin/sh : sh
08-26 11:05:10.690: INFO/ActivityManager(160): Start proc com.noshufou.android.su for broadcast com.noshufou.android.su/.SuNotificationReceiver: pid=868 uid=10035 gids={1015, 3003}
08-26 11:05:10.730: DEBUG/su(862): 10009 lv.n3o.swapper2 executing 0 /system/bin/sh using shell /system/bin/sh : sh
08-26 11:05:11.240: INFO/Swapper(823): H=null EXEC Setting swappiness RESULT true

↓また落ちた？
08-26 11:05:11.510: INFO/ActivityManager(160): Process com.edamametech.android.SiestaWatch (pid 693) has died.
08-26 11:05:11.530: INFO/WindowManager(160): WIN DEATH: Window{43eea248 com.edamametech.android.SiestaWatch/com.edamametech.android.SiestaWatch.SiestaWatchActivity paused=false}
08-26 11:05:11.570: INFO/UsageStats(160): Something wrong here, didn't expect com.android.launcher to be paused
08-26 11:05:12.280: INFO/Swapper(823): Command:    busybox swapon /dev/block/mmcblk0p3
08-26 11:05:12.380: ERROR/Swapper(823): swapon: /dev/block/mmcblk0p3: Device or resource busy
08-26 11:05:12.380: INFO/Swapper(823): H=null EXEC Enabling swap(partition) RESULT false
08-26 11:05:14.990: DEBUG/WifiService(160): ACTION_BATTERY_CHANGED pluggedType: 2
08-26 11:05:14.990: ERROR/Tethering(160): active iface (usb0) reported as added, ignoring
08-26 11:05:18.230: INFO/ActivityManager(160): Start proc com.adamrocker.android.input.simeji for service com.adamrocker.android.input.simeji/.OpenWnnSimeji: pid=876 uid=10032 gids={3003, 1015}
08-26 11:05:18.790: DEBUG/dalvikvm(876): Trying to load lib /data/data/com.adamrocker.android.input.simeji/lib/libwnndict.so 0x43c99ec0
08-26 11:05:18.800: DEBUG/dalvikvm(876): Added shared lib /data/data/com.adamrocker.android.input.simeji/lib/libwnndict.so 0x43c99ec0
08-26 11:05:18.800: DEBUG/dalvikvm(876): No JNI_OnLoad found in /data/data/com.adamrocker.android.input.simeji/lib/libwnndict.so 0x43c99ec0, skipping init
08-26 11:05:19.020: DEBUG/dalvikvm(876): GC_FOR_MALLOC freed 1586 objects / 242824 bytes in 162ms
08-26 11:05:19.160: INFO/ActivityManager(160): Process com.android.settings (pid 796) has died.
08-26 11:05:19.490: DEBUG/dalvikvm(876): GC_FOR_MALLOC freed 412 objects / 349520 bytes in 231ms
08-26 11:05:19.900: WARN/InputMethodManager(239): Ignoring onBind: cur seq=-1, given seq=4
08-26 11:05:24.590: DEBUG/dalvikvm(586): GC_EXPLICIT freed 111 objects / 6776 bytes in 148ms
08-26 11:05:26.150: INFO/EventLogService(451): Aggregate from 1314390925905 (log), 1314390925905 (data)
08-26 11:05:31.240: DEBUG/dalvikvm(594): GC_EXPLICIT freed 271 objects / 13456 bytes in 131ms
08-26 11:05:39.420: DEBUG/dalvikvm(521): GC_EXPLICIT freed 460 objects / 26776 bytes in 106ms
08-26 11:05:44.510: DEBUG/dalvikvm(451): GC_EXPLICIT freed 3267 objects / 297880 bytes in 198ms
08-26 11:06:07.330: DEBUG/dalvikvm(160): GC_FOR_MALLOC freed 15625 objects / 799744 bytes in 201ms
08-26 11:06:08.880: INFO/Swapper(823): Service stopped
